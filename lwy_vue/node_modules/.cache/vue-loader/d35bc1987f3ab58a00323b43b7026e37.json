{"remainingRequest":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\views\\Register.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\views\\Register.vue","mtime":1591957007799},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1591153665092},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1591153664766},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1591153665092},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1591153673467}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport QS from 'qs'\r\nimport { async } from 'q';\r\nimport {iphoneLogin,iphoneReg} from '../assets/js/interface'\r\nexport default {\r\n    data(){\r\n        return{\r\n            phone:\"\",\r\n            pwd:\"\",\r\n            pwd2:\"\",\r\n            reg_phone:\"\",\r\n            reg_pwd:\"\",\r\n            reg_pwd2:\"\",\r\n            flag:{regPhone:false,regPwd:false,regPwd2:false}, //iphone pwd pwd2\r\n            // regCanClick:false\r\n        }\r\n    },\r\n    methods:{\r\n        getPhone(){\r\n            (async ()=>{\r\n                var res=await iphoneLogin({iphone:this.phone});\r\n                if(res.code==-1){\r\n                    this.reg_phone=\"该手机号已被注册\";\r\n                     this.flag.regPhone=false;\r\n                }else if(res.code==1){\r\n                    this.reg_phone=\"\";\r\n                    this.flag.regPhone=true;\r\n                }\r\n            })();\r\n        },\r\n        regTest(str,reg,textP,msg){\r\n            if(reg.test(str)){\r\n                this[textP]=\"\";\r\n                return true;\r\n            }else{\r\n                this[textP]=msg;\r\n                return false;\r\n            }\r\n        },\r\n        blurPhoneHandle(e){\r\n            this.phone=this.phone.trim();\r\n            var reg=/^1[3-9]\\d{9}$/;\r\n            var isCorrect=this.regTest(this.phone,reg,\"reg_phone\",\"手机号格式不正确\");\r\n            // console.log(this.phone,isCorrect);\r\n            if(!isCorrect){\r\n                this.flag.regPhone=false;\r\n            }else{\r\n                // 验证用户手机号是否被使用\r\n                this.getPhone();     \r\n            } \r\n        },\r\n        blurPwdHandle(e){\r\n            this.pwd=this.pwd.trim();\r\n            var reg=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,12}$/;\r\n            var isCorrect=this.regTest(this.pwd,reg,\"reg_pwd\",\"请输入正确格式的密码(6~12位 数字+字母)\");\r\n            if(!isCorrect){\r\n                this.flag.regPwd=false;\r\n            }else{\r\n                this.flag.regPwd=true;\r\n            } \r\n        },\r\n        blurPwd2Handle(e){\r\n            this.pwd2=this.pwd2.trim();\r\n            var pwd2=this.pwd2.replace(/[a-z]/ig,(kw)=>{\r\n                return kw.toUpperCase();\r\n            });\r\n            var pwd=this.pwd.replace(/[a-z]/ig,(kw)=>{\r\n                return kw.toUpperCase();\r\n            });\r\n            if(pwd2!==pwd){\r\n                this.reg_pwd2=\"两次输入密码不一致\";\r\n                this.flag.regPwd2=false;\r\n            }else{\r\n                this.reg_pwd2=\"\";\r\n                this.flag.regPwd2=true;\r\n            }\r\n        },\r\n        // 立即注册单击事件\r\n        regNowHandle(){     \r\n            // console.log(this.flag);\r\n            // for (const key in this.flag) {\r\n            //     if (!this.flag[key]) {\r\n            //         document.getElementById(key).focus();\r\n            //         return;  \r\n            //     }\r\n            // }\r\n            // console.log(\"格式都正确\");\r\n            // return;\r\n            console.log(this.regCanClick);\r\n            if(this.regCanClick){\r\n                //    格式正确       \r\n                (async ()=>{\r\n                    var res=await iphoneReg({\r\n                            iphone:this.phone,\r\n                            upwd:this.pwd2\r\n                    });\r\n                    if(res.code==200){\r\n                        alert(\"注册成功！欢迎您\"+this.phone); \r\n                    //   自动登录\r\n                    var loginRes=await iphoneLogin({\r\n                        iphone:this.phone,\r\n                        upwd:this.pwd2\r\n                    });\r\n                    if(loginRes.code==1){\r\n                        this.$router.push('/');\r\n                    }else{\r\n                        alert('登录失败,请稍后再试');\r\n                    }         \r\n                    }\r\n                })();   \r\n            }\r\n        }\r\n    },\r\n    created(){\r\n\r\n    },\r\n    computed:{\r\n        regCanClick(){\r\n            var sum=0,trueC=0;\r\n            for (const key in this.flag) {\r\n                console.log(this.flag[key]);\r\n                sum++;\r\n                if (this.flag[key]) {\r\n                    trueC++;            \r\n                }\r\n            }\r\n            console.log(trueC==sum);\r\n            return sum==trueC;\r\n        }\r\n    }\r\n}\r\n",{"version":3,"sources":["Register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Register.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div id=\"regContent\">\r\n        <h2>注册礼无忧账号</h2> \r\n        <input id=\"regPhone\" @blur=\"blurPhoneHandle\" placeholder=\"请输入手机号\" v-model=\"phone\" v-autoFocus>\r\n        <div v-text=\"reg_phone\"></div>\r\n        <input id=\"regPwd\" @blur=\"blurPwdHandle\" type=\"password\" placeholder=\"请输入密码6-12位(字母+数字)\" v-model=\"pwd\">\r\n        <div v-text=\"reg_pwd\"></div>\r\n        <input id=\"regPwd2\" @blur=\"blurPwd2Handle\" type=\"password\" placeholder=\"再次输入密码\" v-model=\"pwd2\">\r\n        <div v-text=\"reg_pwd2\"></div>\r\n        <p>\r\n            注册即为同意\r\n            <a href=\"javascript:;\">《礼无忧用户注册协议》</a>\r\n        </p>\r\n        <input @click=\"regNowHandle\" type=\"button\" value=\"立即注册\" id=\"reg\" :class=\"{disabled:!regCanClick}\">\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport QS from 'qs'\r\nimport { async } from 'q';\r\nimport {iphoneLogin,iphoneReg} from '../assets/js/interface'\r\nexport default {\r\n    data(){\r\n        return{\r\n            phone:\"\",\r\n            pwd:\"\",\r\n            pwd2:\"\",\r\n            reg_phone:\"\",\r\n            reg_pwd:\"\",\r\n            reg_pwd2:\"\",\r\n            flag:{regPhone:false,regPwd:false,regPwd2:false}, //iphone pwd pwd2\r\n            // regCanClick:false\r\n        }\r\n    },\r\n    methods:{\r\n        getPhone(){\r\n            (async ()=>{\r\n                var res=await iphoneLogin({iphone:this.phone});\r\n                if(res.code==-1){\r\n                    this.reg_phone=\"该手机号已被注册\";\r\n                     this.flag.regPhone=false;\r\n                }else if(res.code==1){\r\n                    this.reg_phone=\"\";\r\n                    this.flag.regPhone=true;\r\n                }\r\n            })();\r\n        },\r\n        regTest(str,reg,textP,msg){\r\n            if(reg.test(str)){\r\n                this[textP]=\"\";\r\n                return true;\r\n            }else{\r\n                this[textP]=msg;\r\n                return false;\r\n            }\r\n        },\r\n        blurPhoneHandle(e){\r\n            this.phone=this.phone.trim();\r\n            var reg=/^1[3-9]\\d{9}$/;\r\n            var isCorrect=this.regTest(this.phone,reg,\"reg_phone\",\"手机号格式不正确\");\r\n            // console.log(this.phone,isCorrect);\r\n            if(!isCorrect){\r\n                this.flag.regPhone=false;\r\n            }else{\r\n                // 验证用户手机号是否被使用\r\n                this.getPhone();     \r\n            } \r\n        },\r\n        blurPwdHandle(e){\r\n            this.pwd=this.pwd.trim();\r\n            var reg=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,12}$/;\r\n            var isCorrect=this.regTest(this.pwd,reg,\"reg_pwd\",\"请输入正确格式的密码(6~12位 数字+字母)\");\r\n            if(!isCorrect){\r\n                this.flag.regPwd=false;\r\n            }else{\r\n                this.flag.regPwd=true;\r\n            } \r\n        },\r\n        blurPwd2Handle(e){\r\n            this.pwd2=this.pwd2.trim();\r\n            var pwd2=this.pwd2.replace(/[a-z]/ig,(kw)=>{\r\n                return kw.toUpperCase();\r\n            });\r\n            var pwd=this.pwd.replace(/[a-z]/ig,(kw)=>{\r\n                return kw.toUpperCase();\r\n            });\r\n            if(pwd2!==pwd){\r\n                this.reg_pwd2=\"两次输入密码不一致\";\r\n                this.flag.regPwd2=false;\r\n            }else{\r\n                this.reg_pwd2=\"\";\r\n                this.flag.regPwd2=true;\r\n            }\r\n        },\r\n        // 立即注册单击事件\r\n        regNowHandle(){     \r\n            // console.log(this.flag);\r\n            // for (const key in this.flag) {\r\n            //     if (!this.flag[key]) {\r\n            //         document.getElementById(key).focus();\r\n            //         return;  \r\n            //     }\r\n            // }\r\n            // console.log(\"格式都正确\");\r\n            // return;\r\n            console.log(this.regCanClick);\r\n            if(this.regCanClick){\r\n                //    格式正确       \r\n                (async ()=>{\r\n                    var res=await iphoneReg({\r\n                            iphone:this.phone,\r\n                            upwd:this.pwd2\r\n                    });\r\n                    if(res.code==200){\r\n                        alert(\"注册成功！欢迎您\"+this.phone); \r\n                    //   自动登录\r\n                    var loginRes=await iphoneLogin({\r\n                        iphone:this.phone,\r\n                        upwd:this.pwd2\r\n                    });\r\n                    if(loginRes.code==1){\r\n                        this.$router.push('/');\r\n                    }else{\r\n                        alert('登录失败,请稍后再试');\r\n                    }         \r\n                    }\r\n                })();   \r\n            }\r\n        }\r\n    },\r\n    created(){\r\n\r\n    },\r\n    computed:{\r\n        regCanClick(){\r\n            var sum=0,trueC=0;\r\n            for (const key in this.flag) {\r\n                console.log(this.flag[key]);\r\n                sum++;\r\n                if (this.flag[key]) {\r\n                    trueC++;            \r\n                }\r\n            }\r\n            console.log(trueC==sum);\r\n            return sum==trueC;\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style>\r\n    @import url(../assets/css/register.css);\r\n</style>\r\n\r\n"]}]}