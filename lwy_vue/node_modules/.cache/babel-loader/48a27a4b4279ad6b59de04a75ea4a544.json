{"remainingRequest":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\babel-loader\\lib\\index.js!D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\assets\\js\\axiosConfig.js","dependencies":[{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\assets\\js\\axiosConfig.js","mtime":1591878718205},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1591153665092},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1591153664766}],"contextDependencies":[],"result":["import axios from \"axios\";\nimport qs from \"qs\";\nimport store from \"../../store\";\nimport router from \"../../router\"; // 创建axios实例\n\nvar Axios = axios.create({\n  baseURL: \"http://127.0.0.1:5050/\",\n  withCredentials: true\n}); // 请求拦截器\n\nAxios.interceptors.request.use(function (config) {\n  console.log(\"进入请求拦截器...\");\n  console.log(store.getters.getToken); //this.axios.post(\n  //\"user/signin\",\n  //{uname:dingding , upwd:123456}\n  //)\n\n  if (config.method === \"post\") {\n    config.data = qs.stringify(config.data);\n  }\n\n  if (localStorage.getItem(\"token\")) {\n    config.headers.token = localStorage.getItem(\"token\");\n  }\n\n  if (sessionStorage.getItem(\"token\")) {\n    config.headers.token = sessionStorage.getItem(\"token\");\n  }\n\n  return config;\n}, function (error) {\n  console.log(\"===发送请求拦截器报错===\");\n  console.log(error);\n  console.log(\"===end===\");\n  Promise.reject(error);\n});\nAxios.interceptors.response.use(function (res) {\n  console.log(\"触发响应拦截器...\"); // console.log(res);\n\n  if (res.data.status == 403) {\n    console.log(store.getters.getToken);\n    store.commit(\"logout\");\n    console.log(store.getters.getToken);\n    alert(\"请重新登录\");\n    router.push({\n      name: 'login'\n    });\n  } else if (res.config.url.indexOf(\"user/getUser\") !== -1 && res.data.code == -2) {\n    // store.commit(\"setIslogin\",false);\n    // store.commit(\"setUname\",\"\");\n    // alert(res.data.msg+\" 请先登录 !\");\n    alert(\"用户名或密码错误\");\n  } else if (res.config.url.indexOf(\"/user\") !== -1 && res.data.token) {\n    store.commit(\"setToken\", res.data.token);\n    store.commit(\"setIsLogin\", true);\n    store.commit(\"setuserInfo\", res.data.data[0]); // if(res.remember===\"true\"){\n    //   localStorage.setItem(\"token\",res.data.token);\n    // }else{\n    //   sessionStorage.setItem(\"token\",res.data.token);\n    // }\n  }\n\n  return res;\n}, function (error) {});\nexport default {\n  install: function install(Vue, Option) {\n    Vue.prototype.axios = Axios;\n  }\n};\nexport { Axios };",{"version":3,"sources":["D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\assets\\js\\axiosConfig.js"],"names":["axios","qs","store","router","Axios","create","baseURL","withCredentials","interceptors","request","use","config","console","log","getters","getToken","method","data","stringify","localStorage","getItem","headers","token","sessionStorage","error","Promise","reject","response","res","status","commit","alert","push","name","url","indexOf","code","install","Vue","Option","prototype"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,EAAP,MAAe,IAAf;AACA,OAAOC,KAAP;AACA,OAAOC,MAAP,qB,CACA;;AACA,IAAMC,KAAK,GAACJ,KAAK,CAACK,MAAN,CAAa;AACvBC,EAAAA,OAAO,EAAC,wBADe;AAEvBC,EAAAA,eAAe,EAAC;AAFO,CAAb,CAAZ,C,CAIA;;AACAH,KAAK,CAACI,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CACE,UAAAC,MAAM,EAAE;AACNC,EAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACAD,EAAAA,OAAO,CAACC,GAAR,CAAYX,KAAK,CAACY,OAAN,CAAcC,QAA1B,EAFM,CAGN;AACE;AACA;AACF;;AACA,MAAGJ,MAAM,CAACK,MAAP,KAAgB,MAAnB,EAA0B;AACxBL,IAAAA,MAAM,CAACM,IAAP,GAAYhB,EAAE,CAACiB,SAAH,CAAaP,MAAM,CAACM,IAApB,CAAZ;AACD;;AACD,MAAGE,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAH,EAAiC;AAC/BT,IAAAA,MAAM,CAACU,OAAP,CAAeC,KAAf,GAAqBH,YAAY,CAACC,OAAb,CAAqB,OAArB,CAArB;AACD;;AACD,MAAGG,cAAc,CAACH,OAAf,CAAuB,OAAvB,CAAH,EAAmC;AACjCT,IAAAA,MAAM,CAACU,OAAP,CAAeC,KAAf,GAAqBC,cAAc,CAACH,OAAf,CAAuB,OAAvB,CAArB;AACD;;AACD,SAAOT,MAAP;AACD,CAlBH,EAmBE,UAAAa,KAAK,EAAE;AACLZ,EAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAD,EAAAA,OAAO,CAACC,GAAR,CAAYW,KAAZ;AACAZ,EAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAY,EAAAA,OAAO,CAACC,MAAR,CAAeF,KAAf;AACD,CAxBH;AA0BApB,KAAK,CAACI,YAAN,CAAmBmB,QAAnB,CAA4BjB,GAA5B,CACE,UAAAkB,GAAG,EAAE;AACHhB,EAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EADG,CAEH;;AACA,MAAGe,GAAG,CAACX,IAAJ,CAASY,MAAT,IAAiB,GAApB,EAAwB;AACtBjB,IAAAA,OAAO,CAACC,GAAR,CAAYX,KAAK,CAACY,OAAN,CAAcC,QAA1B;AACAb,IAAAA,KAAK,CAAC4B,MAAN,CAAa,QAAb;AACAlB,IAAAA,OAAO,CAACC,GAAR,CAAYX,KAAK,CAACY,OAAN,CAAcC,QAA1B;AACAgB,IAAAA,KAAK,CAAC,OAAD,CAAL;AACA5B,IAAAA,MAAM,CAAC6B,IAAP,CAAY;AAACC,MAAAA,IAAI,EAAC;AAAN,KAAZ;AACD,GAND,MAMM,IAAGL,GAAG,CAACjB,MAAJ,CAAWuB,GAAX,CAAeC,OAAf,CAAuB,cAAvB,MAAyC,CAAC,CAA1C,IAA+CP,GAAG,CAACX,IAAJ,CAASmB,IAAT,IAAe,CAAC,CAAlE,EAAoE;AACxE;AACA;AACA;AACAL,IAAAA,KAAK,CAAC,UAAD,CAAL;AACD,GALK,MAKA,IAAGH,GAAG,CAACjB,MAAJ,CAAWuB,GAAX,CAAeC,OAAf,CAAuB,OAAvB,MAAkC,CAAC,CAAnC,IAAwCP,GAAG,CAACX,IAAJ,CAASK,KAApD,EAA0D;AAC9DpB,IAAAA,KAAK,CAAC4B,MAAN,CAAa,UAAb,EAAwBF,GAAG,CAACX,IAAJ,CAASK,KAAjC;AACApB,IAAAA,KAAK,CAAC4B,MAAN,CAAa,YAAb,EAA0B,IAA1B;AACA5B,IAAAA,KAAK,CAAC4B,MAAN,CAAa,aAAb,EAA2BF,GAAG,CAACX,IAAJ,CAASA,IAAT,CAAc,CAAd,CAA3B,EAH8D,CAI9D;AACA;AACA;AACA;AACA;AACD;;AACD,SAAOW,GAAP;AACD,CA1BH,EA2BE,UAAAJ,KAAK,EAAE,CAEN,CA7BH;AA+BA,eAAe;AACba,EAAAA,OAAO,EAAE,iBAASC,GAAT,EAAcC,MAAd,EAAqB;AAC5BD,IAAAA,GAAG,CAACE,SAAJ,CAAcxC,KAAd,GAAoBI,KAApB;AACD;AAHY,CAAf;AAKA,SAAQA,KAAR","sourcesContent":["import axios from \"axios\";\nimport qs from \"qs\";\nimport store from '../../store';\nimport router from '../../router'\n// 创建axios实例\nconst Axios=axios.create({\n  baseURL:\"http://127.0.0.1:5050/\",\n  withCredentials:true\n})\n// 请求拦截器\nAxios.interceptors.request.use(\n  config=>{\n    console.log(\"进入请求拦截器...\");\n    console.log(store.getters.getToken);\n    //this.axios.post(\n      //\"user/signin\",\n      //{uname:dingding , upwd:123456}\n    //)\n    if(config.method===\"post\"){\n      config.data=qs.stringify(config.data)\n    }\n    if(localStorage.getItem(\"token\")){\n      config.headers.token=localStorage.getItem(\"token\");\n    }\n    if(sessionStorage.getItem(\"token\")){\n      config.headers.token=sessionStorage.getItem(\"token\");\n    }\n    return config;\n  },\n  error=>{\n    console.log(\"===发送请求拦截器报错===\")\n    console.log(error);\n    console.log(\"===end===\");\n    Promise.reject(error);\n  }\n);\nAxios.interceptors.response.use(\n  res=>{\n    console.log(\"触发响应拦截器...\")\n    // console.log(res);\n    if(res.data.status==403){\n      console.log(store.getters.getToken);\n      store.commit(\"logout\");\n      console.log(store.getters.getToken);\n      alert(\"请重新登录\");\n      router.push({name:'login'});\n    }else if(res.config.url.indexOf(\"user/getUser\")!==-1 && res.data.code==-2){\n      // store.commit(\"setIslogin\",false);\n      // store.commit(\"setUname\",\"\");\n      // alert(res.data.msg+\" 请先登录 !\");\n      alert(\"用户名或密码错误\");\n    }else if(res.config.url.indexOf(\"/user\")!==-1 && res.data.token){\n      store.commit(\"setToken\",res.data.token);\n      store.commit(\"setIsLogin\",true);\n      store.commit(\"setuserInfo\",res.data.data[0]);\n      // if(res.remember===\"true\"){\n      //   localStorage.setItem(\"token\",res.data.token);\n      // }else{\n      //   sessionStorage.setItem(\"token\",res.data.token);\n      // }\n    }\n    return res;\n  },\n  error=>{\n    \n  }\n)\nexport default {\n  install: function(Vue, Option){\n    Vue.prototype.axios=Axios;\n  }\n}\nexport {Axios} "]}]}