{"remainingRequest":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\babel-loader\\lib\\index.js!D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\assets\\js\\axiosConfig.js","dependencies":[{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\assets\\js\\axiosConfig.js","mtime":1591878443865},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1591153665092},{"path":"D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1591153664766}],"contextDependencies":[],"result":["import axios from \"axios\";\nimport qs from \"qs\";\nimport store from \"../../store\";\nimport router from \"../../router\"; // 创建axios实例\n\nvar Axios = axios.create({\n  baseURL: \"http://127.0.0.1:5050/\",\n  withCredentials: true\n}); // 请求拦截器\n\nAxios.interceptors.request.use(function (config) {\n  console.log(\"进入请求拦截器...\"); //this.axios.post(\n  //\"user/signin\",\n  //{uname:dingding , upwd:123456}\n  //)\n\n  if (config.method === \"post\") {\n    config.data = qs.stringify(config.data);\n  }\n\n  if (localStorage.getItem(\"token\")) {\n    config.headers.token = localStorage.getItem(\"token\");\n  }\n\n  if (sessionStorage.getItem(\"token\")) {\n    config.headers.token = sessionStorage.getItem(\"token\");\n  }\n\n  return config;\n}, function (error) {\n  console.log(\"===发送请求拦截器报错===\");\n  console.log(error);\n  console.log(\"===end===\");\n  Promise.reject(error);\n});\nAxios.interceptors.response.use(function (res) {\n  console.log(\"触发响应拦截器...\"); // console.log(res);\n\n  console.log(store.getToken());\n\n  if (res.data.status == 403) {\n    store.commit(\"logout\");\n    console.log(store.getToken());\n    alert(\"请重新登录\");\n    router.push({\n      name: 'login'\n    });\n  } else if (res.config.url.indexOf(\"user/getUser\") !== -1 && res.data.code == -2) {\n    // store.commit(\"setIslogin\",false);\n    // store.commit(\"setUname\",\"\");\n    // alert(res.data.msg+\" 请先登录 !\");\n    alert(\"用户名或密码错误\");\n  } else if (res.config.url.indexOf(\"/user\") !== -1 && res.data.token) {\n    store.commit(\"setToken\", res.data.token);\n    store.commit(\"setIsLogin\", true);\n    store.commit(\"setuserInfo\", res.data.data[0]); // if(res.remember===\"true\"){\n    //   localStorage.setItem(\"token\",res.data.token);\n    // }else{\n    //   sessionStorage.setItem(\"token\",res.data.token);\n    // }\n  }\n\n  return res;\n}, function (error) {});\nexport default {\n  install: function install(Vue, Option) {\n    Vue.prototype.axios = Axios;\n  }\n};\nexport { Axios };",{"version":3,"sources":["D:\\WEB\\lx\\vue\\project\\lwy\\lwy_vue\\src\\assets\\js\\axiosConfig.js"],"names":["axios","qs","store","router","Axios","create","baseURL","withCredentials","interceptors","request","use","config","console","log","method","data","stringify","localStorage","getItem","headers","token","sessionStorage","error","Promise","reject","response","res","getToken","status","commit","alert","push","name","url","indexOf","code","install","Vue","Option","prototype"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport qs from \"qs\";\nimport store from '../../store';\nimport router from '../../router'\n// 创建axios实例\nconst Axios=axios.create({\n  baseURL:\"http://127.0.0.1:5050/\",\n  withCredentials:true\n})\n// 请求拦截器\nAxios.interceptors.request.use(\n  config=>{\n    console.log(\"进入请求拦截器...\");\n    //this.axios.post(\n      //\"user/signin\",\n      //{uname:dingding , upwd:123456}\n    //)\n    if(config.method===\"post\"){\n      config.data=qs.stringify(config.data)\n    }\n    if(localStorage.getItem(\"token\")){\n      config.headers.token=localStorage.getItem(\"token\");\n    }\n    if(sessionStorage.getItem(\"token\")){\n      config.headers.token=sessionStorage.getItem(\"token\");\n    }\n    return config;\n  },\n  error=>{\n    console.log(\"===发送请求拦截器报错===\")\n    console.log(error);\n    console.log(\"===end===\");\n    Promise.reject(error);\n  }\n);\nAxios.interceptors.response.use(\n  res=>{\n    console.log(\"触发响应拦截器...\")\n    // console.log(res);\n    console.log(store.getToken());\n    if(res.data.status==403){\n      store.commit(\"logout\");\n      console.log(store.getToken());\n      alert(\"请重新登录\");\n      router.push({name:'login'});\n    }else if(res.config.url.indexOf(\"user/getUser\")!==-1 && res.data.code==-2){\n      // store.commit(\"setIslogin\",false);\n      // store.commit(\"setUname\",\"\");\n      // alert(res.data.msg+\" 请先登录 !\");\n      alert(\"用户名或密码错误\");\n    }else if(res.config.url.indexOf(\"/user\")!==-1 && res.data.token){\n      store.commit(\"setToken\",res.data.token);\n      store.commit(\"setIsLogin\",true);\n      store.commit(\"setuserInfo\",res.data.data[0]);\n      // if(res.remember===\"true\"){\n      //   localStorage.setItem(\"token\",res.data.token);\n      // }else{\n      //   sessionStorage.setItem(\"token\",res.data.token);\n      // }\n    }\n    return res;\n  },\n  error=>{\n    \n  }\n)\nexport default {\n  install: function(Vue, Option){\n    Vue.prototype.axios=Axios;\n  }\n}\nexport {Axios} "]}]}